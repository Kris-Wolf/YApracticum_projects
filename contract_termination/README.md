# Разметка токсичных комментариев
## Описание проекта
Разработка модели машинного обучения, предсказывающей разорвёт ли абонент договор.
## Навыки и инструменты
- catboost
- lightgbm
- matplotlib.**pyplot**
- numpy
- pandas
- phik
  - phik.**phik_matrix**
  - phik.report.**plot_correlation_matrix**
- re
- seaborn
- sklearn
  - sklearn.compose.**ColumnTransformer**
  - sklearn.dummy.**DummyClassifier**
  - sklearn.ensemble.**RandomForestClassifier**
  - sklearn.impute.**SimpleImputer**
  - sklearn.linear_model.**LogisticRegression**
  - sklearn.metrics.**confusion_matrix**
  - sklearn.metrics.**roc_auc_score** 
  - sklearn.**model_selection**
  - sklearn.pipeline.**Pipeline**
  - sklearn.**preprocessing**
  - sklearn.tree.**DecisionTreeClassifier**

## Общий вывод
**Цели проекта выполнены:** 
- Загружены данные, таблицы объединены в единый датафрейм.
- Проведено аналитическое исследование данных.
- Подготовлены выборки для обучения моделей.
- Обучены разные модели и подобраны гиперпараметры.
- Проанализировано качество моделей и выбрана лучшая, предсказывающая готовых разорвать контракт абонентов, проверено её качество на тестовой выборке, построена матрица ошибок.

#### Описание лучшей модели
Лучшая модель - **модель CatBoost** со следующими параметрами:
- `{'learning_rate': 0.3, 'l2_leaf_reg': 3, 'iterations': 600, 'depth': 2}`
- Метрика **ROC-AUC** на кросс-валидации состявляет: `0.93`.
- Метрика **ROC-AUC** на тестовой выборке состявляет: `0.93`.

*Метрика соответствует поставленному заказчиком критерию: **ROC-AUC**>=0.85.*

При обучении этой модели машинного обучения данные не кодировали и не масштабировали, также не учитывался дисбаланс классов, т.к. CatBoost хорошо работает с "сырыми" данными.
Полученная модель выполняет необходимые условия и решает поставленные бизнесом задачи, а именно предсказывает абонентов, желающих расторгнуть контракт.

- Предсказания модели можно улучшить, для этого можно собрать дополнительную информацию или создать больше признаков, также можно уменьшить дисбаланс классов или использовать другие модели.
