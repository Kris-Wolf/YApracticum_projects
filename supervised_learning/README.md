# Обучение с учителем: качество модели
## Описание проекта
Разработка решения для интернет-магазина, которое позволит персонализировать предложения постоянным клиентам, чтобы увеличить их покупательскую активность.
## Навыки и инструменты
- matplotlib.**pyplot**
- numpy
- pandas
- seaborn
- shap
- sklearn.compose.**ColumnTransformer**
- sklearn.impute.**SimpleImputer**
- sklearn.linear_model.**LogisticRegression**
- sklearn.**metrics**
- sklearn.**model_selection**
- sklearn.neighbors.**KNeighborsClassifier**
- sklearn.pipeline.**Pipeline**
- sklearn.**preprocessing**
- sklearn.svm.**SVC**
- sklearn.tree.**DecisionTreeClassifier**
## Общий вывод
**Целью проекта определено следующее:**
- Построить модель, предсказывающую вероятность снижения покупательской активности клиента.
- Используя данные модели и данные о прибыльности клиентов, выделить сегменты покупателей и разработать для них персонализированные предложения.

**Для поиска лучшей модели проделаны следующие шаги:**
- В ходе предобработки данных изучены данные:
    - названия столбцов приведены к стандарту,
    - обработаны пропуски и дубликаты, 
    - исправлены орфографические ошибки в данных.
- В результате исследовательского анализа данных обнаружены и обработаны аномальные значения и выбросы.
- Таблицы `market_file.csv`, `market_money.csv` и `market_time.csv` объединены для увеличения признаков и улучшения качества будующей модели;
- Проведен корреляционный анализ признаков для проверки наличия мультиколлинеарности, которая мешает моделированию.
- Для автоматизации предобработки признаков использованы пайплайны.
- С помощью пайплайнов и автоматизированного поиска гипермараметров подобраны лучшие способы обработки, лучшие гиперпараметры и лучшая модель. Оценка производилась по метрике ROC-AUC, подходящей для бинарной классификации и оченивающей качество решений модели в общем виде, учитывая все возможные пороговые значения.

  **Лучшая модель:** `KNeighborsClassifier(n_neighbors=7)`.

После подбора лучшей модели проведен **анализ важности признаков.**
- Малозначимыми признаками для предсказания снижения уровня активности покупателя являются: 
    - `разрешить_сообщать` - согласие покупателя на дополнительные предложения о товаре;
    - `ошибка_сервиса` - число сбоев, которые коснулись покупателя во время посещения сайта.
    - данные за текущий месяц (выручка и проведенное на сайте время), скорее всего, неполные, поэтому к ним следует относиться с осторожностью.
- Важными для предсказания цснижения уровня активности покупателя являются следующие признаки:
    - `популярная_категория` - самая популярная категория товаров у покупателя за последние 6 месяцев;
    - `тип_сервиса` - уровень сервиса, например «премиум» и «стандарт»;
    - `длительность` - сколько дней прошло с момента регистрации покупателя на сайте;
    - `маркет_актив_6_мес` - среднемесячное значение маркетинговых коммуникаций компании, которое приходилось на покупателя за последние 6 месяцев;
    - `выручка_предыдущий_месяц` - сумма выручки с покупателя за пердыдущий месяц.
    
ТО ЕСТЬ при моделировании и принятии бизнес-решений **следует учитывать** популярную категорию пользователя и его тип сервиса, обращать внимание на кол-во неоплаченных позиций в корзине за квартал, проведенное пользователем время на сайте и сколько времени прошло с момента регистрации пользователя на сайте.

Завершает исследование **сегментация покупателей**. Выбрана категория пользователей со сниженной активностью и высокой прибылью.

- **Предложения по работе с сегментом для увеличения покупательской активности следующие:**
    - Маркетинговые компании способствуют покупательской активности, но рассылки с дополнительной информацией о товаре практически не влияют на активность.
    
    - Среди покупателей со сниженной активностью и высокой прибылью наиболее прибыльными являются категории `Товары для детей`, `Косметика и аксессуары` и `Домашний текстиль`.
        - Техника и посуда - это товары длительного пользования. То, что данные категории редко появляются среди популярных, может означать, что у покупателей уже есть необходимый товар и что позиции из данных категорий его не интересуют. Значит, клиентам можно **предложить смежные товары и/или категории.**
        
    - Среднемесячная доля покупок по акции от общего числа покупок за последние 6 месяцев среди выбранного сегмента покупателей лидирует у категорий `Товары для детей`, `Техника для красоты и здоровья` и `Кухонная посуда`. Доли акционных покупок на достаточно популярные категорит `Косметику и аксессуары` и `Домашний текстиль` ниже ожидаемого. Скорее всего, это связано с тем, что среднемесячная маркетинговая коммуникация для категории `Техника для красоты и здоровья` выше, чем среди более популярных категорий - `Косметики и аксессуаров` и `Домашнего текстиля`.
        - Следует **увеличить количество маркетинговых коммуникаций компании в популярных категориях** (`Косметика и аксессуары` и `Домашний текстиль`).
        
    - Чаще всего на другие категории обращают внимание пользователи с популярной категорией `Товары для детей`. Среднее количество страниц, которые просмотрел покупатель за один визит на сайт выделяется у пользователей с популярной категорией `Кухонная посуда`, за ней следуют `Товары для детей` и `Косметика и аксессуары`. 
        - **От наличия акций зависит время, количество страниц и категорий, просмотренных покупателями.** То есть акции - это хороший способ показать разнообразие товаров и заинтересовать клиентов со сниженной активностью в дальнейших покупках.
